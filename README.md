# MuTrans Analysis of iPSC Cardiomyocyte Differentiation using SEACells

This repository contains the complete, reproducible analysis pipeline for identifying transitional dynamics in iPSC-derived cardiomyocytes. The analysis first uses **SEACells** to aggregate the dataset into metacells and then applies **MuTrans** to model cellular dynamics and identify attractor states.


---

## ğŸ›ï¸ Project Structure

The repository is organized into a modular pipeline:

```
ipsc_cardiomyocyte_dynamics/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                # Original, immutable data
â”‚   â”‚   â””â”€â”€ GSE175634_iPSC_CM.sct3k_reclustered.h5ad
â”‚   â””â”€â”€ processed/          # Data generated by our pipeline
â”‚       â”œâ”€â”€ seacells/       # Outputs from 01_run_seacells.py
â”‚       â””â”€â”€ mutrans/        # Outputs from 02_run_mutrans.py
â”‚
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ 01_SEACell_Computation.ipynb  # Interactive version of 01 script
â”‚   â”œâ”€â”€ 02_MuTrans_Analysis.ipynb     # Interactive version of 02 script
â”‚   â”œâ”€â”€ 03_Transcendental_Analysis_Heatmaps.ipynb # Explores heatmap generation
â”‚   â”œâ”€â”€ 04_Comprehensive_Figure_Assembly.ipynb    # Builds the final figures
â”‚   â””â”€â”€ sandbox.ipynb               # For scratch work
â”‚
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ figures/              # All plots, organized by analysis step
â”‚   â””â”€â”€ tables/               # CSV outputs (e.g., lineage networks)
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ 01_run_seacells.py    # Computes SEACells from raw data
â”‚   â”œâ”€â”€ 02_run_mutrans.py     # Runs MuTrans on SEACells
â”‚   â”œâ”€â”€ 03_generate_all_figures.py # Generates all main/supplemental figures
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py             # Central configuration (paths, parameters)
â”‚   â”œâ”€â”€ transcendental.py     # Core analysis logic (TCS, gene identification)
â”‚   â”œâ”€â”€ plotting.py           # Reusable plotting functions (heatmaps, UMAPs)
â”‚
â”œâ”€â”€ environment.yml           # Conda environment for reproducibility
â””â”€â”€ README.md                 # You are here
```

---

## ğŸš€ Setup & Installation

**1. Clone the Repository:**
```bash
git clone https://github.com/MohsenZand/ipsc_cardiomyocyte.git
cd ipsc_cardiomyocyte
```

**2. Create Conda Environment:**
```bash
conda env create -f environment.yml
conda activate ipsc_mutrans_seacells
```

**3. Install `pyMuTrans` (Manual Step):**


**4. Download Data:**
Place the raw data file `GSE175634_iPSC_CM.sct3k_reclustered.h5ad` into the `data/raw/` directory.

---

## ğŸ”¬ Running the Analysis

You can run the full pipeline from the command line or step through it interactively in the notebooks.

### Option A: Run End-to-End Pipeline (Scripts)

Run the scripts in order from the project's root directory:

**Step 1: Compute SEACells**
```bash
python scripts/01_run_seacells.py
```
* **Input:** `data/raw/GSE175634_iPSC_CM...h5ad`
* **Output:** `data/processed/seacells/*.h5ad`

**Step 2: Run MuTrans Analysis**
```bash
python scripts/02_run_mutrans.py
```
* **Input:** `data/processed/seacells/*.h5ad`
* **Output:** `data/processed/mutrans/*.h5ad` and `results/tables/*.csv`

**Step 3: Generate All Figures**
```bash
python scripts/03_generate_all_figures.py
```
* **Input:** `data/processed/mutrans/*.h5ad`
* **Output:** `results/figures/` (all final figures)

### Option B: Interactive Exploration (Notebooks)


